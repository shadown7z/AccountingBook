import { BillService } from '../service/BillService'
import { BillRecord, BillType, BillStatistics } from '../model/BillRecord'
import { AccountService } from '../service/AccountService'
import { Account } from '../model/Account'
import { BudgetService } from '../service/BudgetService'
import { Budget, BudgetStatistics } from '../model/Budget'
import { PagePath } from '../constants/PagePath'
import { router } from '@kit.ArkUI'
import { HMRouterMgr } from '@hadss/hmrouter'

@Entry
@ComponentV2
struct Index {
  @Local billService: BillService = BillService.getInstance()
  @Local statistics: BillStatistics = new BillStatistics()
  @Local recentRecords: BillRecord[] = []
  @Local accounts: Account[] = []
  @Local totalBalance: number = 0
  @Local budgetStatistics: BudgetStatistics = new BudgetStatistics()
  @Local currentBudgets: Budget[] = []
  private accountService = AccountService.getInstance()
  private budgetService = BudgetService.getInstance()

  aboutToAppear() {
    this.loadData()
  }

  onPageShow() {
    // È°µÈù¢ÊòæÁ§∫Êó∂Âà∑Êñ∞Êï∞ÊçÆ
    this.loadData()
  }

  private async loadData(): Promise<void> {
    this.statistics = await this.billService.getStatistics()
    this.recentRecords = await this.billService.getRecentBillRecords(5)
    this.accounts = await this.accountService.getAllAccounts()
    this.calculateTotalBalance()
    
    // Âä†ËΩΩÈ¢ÑÁÆóÊï∞ÊçÆ
    const now = new Date()
    this.budgetStatistics = await this.budgetService.getBudgetStatistics(now.getFullYear(), now.getMonth() + 1)
    this.currentBudgets = await this.budgetService.getCurrentMonthBudgets()
  }

  // ËÆ°ÁÆóÊÄª‰ΩôÈ¢ù
  private calculateTotalBalance(): void {
    this.totalBalance = this.accounts.reduce((sum, account) => sum + account.balance, 0)
  }

  build() {
    Column() {
      // È°∂ÈÉ®Ê†áÈ¢òÊ†è
      this.buildHeader()
      
      // ÊªöÂä®ÂÜÖÂÆπÂå∫Âüü
      Scroll() {
        Column({ space: 16 }) {
          // Êî∂ÊîØÊ¶ÇËßàÂç°Áâá
          this.buildOverviewCard()
          
          // Ë¥¶Êà∑Ê¶ÇËßà
          this.buildAccountSection()
          
          // È¢ÑÁÆóÊ¶ÇËßà
          this.buildBudgetSection()
          
          // Âø´ÈÄüËÆ∞Ë¥¶ÊåâÈíÆ
          this.buildQuickActionButton()
          
          // Êï∞ÊçÆÁªüËÆ°ÂÖ•Âè£
          this.buildStatisticsEntry()
          
          // ÂàÜÁ±ªÁÆ°ÁêÜÂÖ•Âè£
          this.buildCategoryManageEntry()
          
          // Êï∞ÊçÆÂ§á‰ªΩÂÖ•Âè£
          this.buildBackupEntry()
          
          // Ê°åÈù¢Âç°ÁâáÂÖ•Âè£
          this.buildWidgetEntry()
          
          // ÊèêÈÜíËÆæÁΩÆÂÖ•Âè£
          this.buildReminderEntry()
          
          // ÂèçÈ¶à‰∏≠ÂøÉÂÖ•Âè£
          this.buildFeedbackEntry()
          
          // ÊúÄËøëËÆ∞ÂΩï
          this.buildRecentRecords()
        }
        .padding({ left: 16, right: 16, bottom: 20 })
      }
      .layoutWeight(1)
    }
    .width('100%')
    .height('100%')
    .backgroundColor($r('app.color.background_color'))
  }

  // ÊûÑÂª∫È°∂ÈÉ®Ê†áÈ¢òÊ†è
  @Builder
  buildHeader() {
    Row() {
      Text($r('app.string.home_title'))
        .fontSize(20)
        .fontWeight(FontWeight.Bold)
        .fontColor($r('app.color.text_primary'))
        .textAlign(TextAlign.Center)
      
      // ÂØºÂá∫ÊåâÈíÆ
      // Button('ÂØºÂá∫')
      //   .type(ButtonType.Normal)
      //   .backgroundColor($r('app.color.primary_color'))
      //   .fontColor(Color.White)
      //   .borderRadius(8)
      //   .fontSize(14)
      //   .padding({ left: 12, right: 12, top: 6, bottom: 6 })
      //   .onClick(() => {
      //     router.pushUrl({
      //       url: 'pages/ExportPage'
      //     })
      //   })
    }
    .width('100%')
    .height(56)
    .padding({ left: 16, right: 16 })
    .justifyContent(FlexAlign.Center)
    .alignItems(VerticalAlign.Center)
    .backgroundColor($r('app.color.primary_color'))
  }

  // ÊûÑÂª∫Êî∂ÊîØÊ¶ÇËßàÂç°Áâá
  @Builder
  buildOverviewCard() {
    Column({ space: 16 }) {
      // ÊÄª‰ΩôÈ¢ù
      Column({ space: 4 }) {
        Text($r('app.string.total_balance'))
          .fontSize(14)
          .fontColor($r('app.color.text_secondary'))
        
        Text(`¬•${BillService.formatAmount(this.statistics.balance)}`)
          .fontSize(28)
          .fontWeight(FontWeight.Bold)
          .fontColor($r('app.color.text_primary'))
      }
      .alignItems(HorizontalAlign.Center)
      
      // Êú¨ÊúàÊî∂ÊîØ
      Row() {
        // ÊÄªËµÑ‰∫ß
        Column({ space: 4 }) {
          Text('ÊÄªËµÑ‰∫ß')
            .fontSize(12)
            .fontColor($r('app.color.text_secondary'))
          
          Text(`¬•${BillService.formatAmount(this.totalBalance)}`)
            .fontSize(18)
            .fontWeight(FontWeight.Bold)
            .fontColor($r('app.color.primary_color'))
        }
        .layoutWeight(1)
        .alignItems(HorizontalAlign.Center)
        
        // ÂàÜÂâ≤Á∫ø
        Divider()
          .vertical(true)
          .height(40)
          .color($r('app.color.divider_color'))
        
        // Êú¨ÊúàÊî∂ÂÖ•
        Column({ space: 4 }) {
          Text($r('app.string.monthly_income'))
            .fontSize(12)
            .fontColor($r('app.color.text_secondary'))
          
          Text(`¬•${BillService.formatAmount(this.statistics.monthlyIncome)}`)
            .fontSize(16)
            .fontWeight(FontWeight.Medium)
            .fontColor($r('app.color.income_color'))
        }
        .layoutWeight(1)
        .alignItems(HorizontalAlign.Center)
        
        // ÂàÜÂâ≤Á∫ø
        Divider()
          .vertical(true)
          .height(40)
          .color($r('app.color.divider_color'))
        
        // Êú¨ÊúàÊîØÂá∫
        Column({ space: 4 }) {
          Text($r('app.string.monthly_expense'))
            .fontSize(12)
            .fontColor($r('app.color.text_secondary'))
          
          Text(`¬•${BillService.formatAmount(this.statistics.monthlyExpense)}`)
            .fontSize(16)
            .fontWeight(FontWeight.Medium)
            .fontColor($r('app.color.expense_color'))
        }
        .layoutWeight(1)
        .alignItems(HorizontalAlign.Center)
      }
      .width('100%')
    }
    .width('100%')
    .padding(20)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
  }

  // ÊûÑÂª∫Âø´ÈÄüËÆ∞Ë¥¶ÊåâÈíÆ
  @Builder
  buildQuickActionButton() {
    Button($r('app.string.add_record'))
      .width('100%')
      .height(48)
      .fontSize(16)
      .fontWeight(FontWeight.Medium)
      .backgroundColor($r('app.color.primary_color'))
      .borderRadius(24)
      .onClick(() => {
        this.navigateToAddRecord()
      })
  }

  // ÊûÑÂª∫ÊúÄËøëËÆ∞ÂΩïÂàóË°®
  @Builder
  buildRecentRecords() {
    Column({ space: 12 }) {
      // Ê†áÈ¢òË°å
      Row() {
        Text($r('app.string.recent_records'))
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .fontColor($r('app.color.text_primary'))
        
        Blank()
        
        Text($r('app.string.view_all'))
          .fontSize(14)
          .fontColor($r('app.color.primary_color'))
          .onClick(() => {
            this.navigateToRecordList()
          })
      }
      .width('100%')
      
      // ËÆ∞ÂΩïÂàóË°®
      if (this.recentRecords.length > 0) {
        Column({ space: 8 }) {
          ForEach(this.recentRecords, (record: BillRecord) => {
            this.buildRecordItem(record)
          })
        }
        .width('100%')
      } else {
        // Á©∫Áä∂ÊÄÅ
        Column({ space: 8 }) {
          Text('üêª')
            .fontSize(32)
          
          Text($r('app.string.no_records'))
            .fontSize(14)
            .fontColor($r('app.color.text_secondary'))
        }
        .width('100%')
        .padding(40)
        .alignItems(HorizontalAlign.Center)
      }
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
  }

  // ÊûÑÂª∫Âçï‰∏™ËÆ∞ÂΩïÈ°π
  @Builder
  buildRecordItem(record: BillRecord) {
    Row({ space: 12 }) {
      // ÂàÜÁ±ªÂõæÊ†á
      Stack() {
        Text(this.getCategoryIcon(record.category))
          .fontSize(20)
          .width(40)
          .height(40)
          .textAlign(TextAlign.Center)
          .backgroundColor($r('app.color.background_color'))
          .borderRadius(20)
        
        // È¢úËâ≤ÊåáÁ§∫Âô®
        Circle({ width: 10, height: 10 })
          .fill(this.getCategoryColor(record.category))
          .stroke(Color.White)
          .strokeWidth(1)
          .position({ x: 30, y: 30 })
      }
      .width(40)
      .height(40)
      
      // ËÆ∞ÂΩï‰ø°ÊÅØ
      Column({ space: 2 }) {
        Row() {
          Text(record.category)
            .fontSize(14)
            .fontWeight(FontWeight.Medium)
            .fontColor($r('app.color.text_primary'))
          
          if (record.note) {
            Text(`¬∑${record.note}`)
              .fontSize(12)
              .fontColor($r('app.color.text_secondary'))
              .maxLines(1)
              .textOverflow({ overflow: TextOverflow.Ellipsis })
          }
        }
        .width('100%')
        
        Text(record.date)
          .fontSize(12)
          .fontColor($r('app.color.text_secondary'))
      }
      .layoutWeight(1)
      .alignItems(HorizontalAlign.Start)
      
      // ÈáëÈ¢ù
      Text(`${record.type === BillType.INCOME ? '+' : '-'}¬•${BillService.formatAmount(record.amount)}`)
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor(record.type === BillType.INCOME ? $r('app.color.income_color') : $r('app.color.expense_color'))
    }
    .width('100%')
    .padding({ top: 8, bottom: 8 })
  }

  // Ë∑≥ËΩ¨Âà∞ËÆ∞Ë¥¶È°µÈù¢
  private navigateToAddRecord(): void {
    router.pushUrl({
      url: PagePath.ADD_RECORD
    })
  }

  // Ë∑≥ËΩ¨Âà∞Ë¥¶ÂçïÂàóË°®È°µÈù¢
  private navigateToRecordList(): void {
    router.pushUrl({
      url: PagePath.BILL_LIST
    })
  }

  // Ë∑≥ËΩ¨Âà∞Ë¥¶Êà∑ÁÆ°ÁêÜÈ°µÈù¢
  private navigateToAccountManage(): void {
    router.pushUrl({
      url: PagePath.ACCOUNT_MANAGE
    })
  }

  // Ë∑≥ËΩ¨Âà∞È¢ÑÁÆóËÆæÁΩÆÈ°µÈù¢
  private navigateToBudgetSetting(): void {
    router.pushUrl({
      url: PagePath.BUDGET_SETTING
    })
  }

  // Ë∑≥ËΩ¨Âà∞ÁªüËÆ°È°µÈù¢
   navigateToStatistics() {
     router.pushUrl({
       url: PagePath.STATISTICS
     })
   }

  // Ë∑≥ËΩ¨Âà∞ÂàÜÁ±ªÁÆ°ÁêÜÈ°µÈù¢
  private navigateToCategoryManage(): void {
    router.pushUrl({
      url: PagePath.CATEGORY_MANAGE
    })
  }

  // Ë∑≥ËΩ¨Âà∞Â§á‰ªΩÈ°µÈù¢
  private navigateToBackup(): void {
    router.pushUrl({
      url: PagePath.BACKUP
    })
  }

  // Ê∑ªÂä†Ê°åÈù¢Âç°Áâá
  private addWidgetToDesktop(): void {
    try {
      // ËøôÈáåÂèØ‰ª•Ë∞ÉÁî®Á≥ªÁªüAPIÊù•Ê∑ªÂä†Ê°åÈù¢Âç°Áâá
      // ÊàñËÄÖÊòæÁ§∫Ê∑ªÂä†Âç°ÁâáÁöÑÂºïÂØº‰ø°ÊÅØ
      AlertDialog.show({
        title: 'Ê∑ªÂä†Ê°åÈù¢Âç°Áâá',
        message: 'ÈïøÊåâÊ°åÈù¢Á©∫ÁôΩÂ§ÑÔºåÈÄâÊã©"ÊúçÂä°Âç°Áâá"ÔºåÁÑ∂ÂêéÈÄâÊã©"ÁÜäÂÆùËÆ∞Ë¥¶"Âç≥ÂèØÊ∑ªÂä†Ê°åÈù¢Âç°Áâá„ÄÇ',
        confirm: {
          value: 'Áü•ÈÅì‰∫Ü',
          action: () => {}
        }
      })
    } catch (error) {
      console.error('Failed to show widget guide:', error)
    }
  }

  // Ë∑≥ËΩ¨Âà∞ÊèêÈÜíËÆæÁΩÆÈ°µÈù¢
  private navigateToReminder(): void {
    router.pushUrl({
      url: 'pages/ReminderPage'
    })
  }

  // ÊûÑÂª∫Ë¥¶Êà∑Ê¶ÇËßà
  @Builder
  buildAccountSection() {
    Column({ space: 12 }) {
      // Ê†áÈ¢òË°å
      Row() {
        Text('ÊàëÁöÑË¥¶Êà∑')
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .fontColor($r('app.color.text_primary'))
        
        Blank()
        
        Text('ÁÆ°ÁêÜ')
          .fontSize(14)
          .fontColor($r('app.color.primary_color'))
          .onClick(() => {
            this.navigateToAccountManage()
          })
      }
      .width('100%')
      
      // Ë¥¶Êà∑ÂàóË°®
      if (this.accounts.length > 0) {
        Column({ space: 8 }) {
          ForEach(this.accounts.slice(0, 3), (account: Account) => {
            Row() {
              Text(account.name)
                .fontSize(14)
                .fontColor($r('app.color.text_primary'))
                .layoutWeight(1)
              
              Text(`¬•${BillService.formatAmount(account.balance)}`)
                .fontSize(14)
                .fontWeight(FontWeight.Medium)
                .fontColor($r('app.color.text_primary'))
            }
            .width('100%')
            .padding({ top: 8, bottom: 8 })
          })
        }
        .width('100%')
      } else {
        Text('ÊöÇÊó†Ë¥¶Êà∑')
          .fontSize(14)
          .fontColor($r('app.color.text_secondary'))
          .padding(20)
      }
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
  }

  // Ëé∑ÂèñÂàÜÁ±ªÂõæÊ†á
  private getCategoryIcon(category: string): string {
    const iconMap: Record<string, string> = {
      'È§êÈ•Æ': 'üçΩÔ∏è',
      '‰∫§ÈÄö': 'üöó',
      'Ë¥≠Áâ©': 'üõí',
      'Â®±‰πê': 'üéÆ',
      'ÂåªÁñó': 'üè•',
      'ÊïôËÇ≤': 'üìö',
      '‰ΩèÊàø': 'üè†',
      'Â∑•ËµÑ': 'üí∞',
      'Â•ñÈáë': 'üéÅ',
      'ÊäïËµÑ': 'üìà',
      'ÂÖºËÅå': 'üíº',
      'ÂÖ∂‰ªñ': 'üìù'
    }
    return iconMap[category] || 'üìù'
  }

  // Ëé∑ÂèñÂàÜÁ±ªÈ¢úËâ≤
  private getCategoryColor(category: string): string {
    const categories = this.billService.getCategories(BillType.EXPENSE).concat(this.billService.getCategories(BillType.INCOME))
    const categoryObj = categories.find(cat => cat.name === category)
    return categoryObj?.color || '#FF6B6B'
  }

  // ÊûÑÂª∫ÁªüËÆ°ÂÖ•Âè£
  @Builder
  buildStatisticsEntry() {
    Row() {
      Text('üìä')
        .fontSize(20)
        .margin({ right: 12 })
      
      Text('Êï∞ÊçÆÁªüËÆ°')
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
      
      Text('Êü•ÁúãËØ¶ÊÉÖ')
        .fontSize(14)
        .fontColor($r('app.color.primary_color'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
    .onClick(() => {
      this.navigateToStatistics()
    })
  }

  // ÊûÑÂª∫ÂàÜÁ±ªÁÆ°ÁêÜÂÖ•Âè£
  @Builder
  buildCategoryManageEntry() {
    Row() {
      Text('üè∑Ô∏è')
        .fontSize(20)
        .margin({ right: 12 })
      
      Text('ÂàÜÁ±ªÁÆ°ÁêÜ')
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
      
      Text('ÁÆ°ÁêÜÂàÜÁ±ª')
        .fontSize(14)
        .fontColor($r('app.color.primary_color'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
    .onClick(() => {
      this.navigateToCategoryManage()
    })
  }

  // ÊûÑÂª∫Â§á‰ªΩÂÖ•Âè£
  @Builder
  buildBackupEntry() {
    Row() {
      Text('üíæ')
        .fontSize(20)
        .margin({ right: 12 })
      
      Text('Êï∞ÊçÆÂ§á‰ªΩ')
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
      
      Text('Â§á‰ªΩÊÅ¢Â§ç')
        .fontSize(14)
        .fontColor($r('app.color.primary_color'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
    .onClick(() => {
      this.navigateToBackup()
    })
  }

  // ÊûÑÂª∫Ê°åÈù¢Âç°ÁâáÂÖ•Âè£
  @Builder
  buildWidgetEntry() {
    Row() {
      Text('üì±')
        .fontSize(20)
        .margin({ right: 12 })
      
      Text('Ê°åÈù¢Âç°Áâá')
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
      
      Text('Ê∑ªÂä†Âç°Áâá')
        .fontSize(14)
        .fontColor($r('app.color.primary_color'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
    .onClick(() => {
      this.addWidgetToDesktop()
    })
  }

  // ÊûÑÂª∫ÊèêÈÜíËÆæÁΩÆÂÖ•Âè£
  @Builder
  buildReminderEntry() {
    Row() {
      Text('üîî')
        .fontSize(20)
        .margin({ right: 12 })
      
      Text('ÊèêÈÜíËÆæÁΩÆ')
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
      
      Text('ËÆæÁΩÆÊèêÈÜí')
        .fontSize(14)
        .fontColor($r('app.color.primary_color'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
    .onClick(() => {
      this.navigateToReminder()
    })
  }

  // ÊûÑÂª∫È¢ÑÁÆóÊ¶ÇËßà
  @Builder
  buildBudgetSection() {
    Column({ space: 12 }) {
      // Ê†áÈ¢òË°å
      Row() {
        Text('Êú¨ÊúàÈ¢ÑÁÆó')
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .fontColor($r('app.color.text_primary'))
        
        Blank()
        
        Text('ËÆæÁΩÆ')
          .fontSize(14)
          .fontColor($r('app.color.primary_color'))
          .onClick(() => {
            this.navigateToBudgetSetting()
          })
      }
      .width('100%')
      
      // È¢ÑÁÆó‰ø°ÊÅØ
      if (this.currentBudgets.length > 0) {
        Column({ space: 8 }) {
          ForEach(this.currentBudgets.slice(0, 3), (budget: Budget) => {
            Row() {
              Column({ space: 4 }) {
                Text(budget.category)
                  .fontSize(14)
                  .fontColor($r('app.color.text_primary'))
                
                Text(`Â∑≤Áî® ¬•${BillService.formatAmount(budget.spent)} / ¬•${BillService.formatAmount(budget.amount)}`)
                   .fontSize(12)
                   .fontColor($r('app.color.text_secondary'))
              }
              .alignItems(HorizontalAlign.Start)
              .layoutWeight(1)
              
              // ËøõÂ∫¶Êù°
               Progress({
                 value: budget.spent,
                 total: budget.amount,
                 type: ProgressType.Linear
               })
                 .width(80)
                 .height(6)
                 .color(budget.spent > budget.amount ? $r('app.color.expense_color') : $r('app.color.primary_color'))
            }
            .width('100%')
            .padding({ top: 8, bottom: 8 })
          })
        }
        .width('100%')
      } else {
        Text('ÊöÇÊó†È¢ÑÁÆóËÆæÁΩÆ')
          .fontSize(14)
          .fontColor($r('app.color.text_secondary'))
          .padding(20)
      }
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
  }

  // ÊûÑÂª∫ÂèçÈ¶à‰∏≠ÂøÉÂÖ•Âè£
  @Builder
  buildFeedbackEntry() {
    Row() {
      Text('üí¨')
        .fontSize(20)
        .margin({ right: 12 })
      
      Text('ÂèçÈ¶à‰∏≠ÂøÉ')
        .fontSize(16)
        .fontWeight(FontWeight.Medium)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
      
      Text('ÊÑèËßÅÂª∫ËÆÆ')
        .fontSize(14)
        .fontColor($r('app.color.primary_color'))
    }
    .width('100%')
    .padding(16)
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(12)
    .shadow({
      radius: 8,
      color: '#1A000000',
      offsetX: 0,
      offsetY: 2
    })
    .onClick(() => {
      this.navigateToFeedback()
    })
  }

  // ÂØºËà™Âà∞ÂèçÈ¶àÈ°µÈù¢
  private navigateToFeedback() {
    // Ë∑≥ËΩ¨Âà∞‰ºÅ‰∏öÂæÆ‰ø°‰∫åÁª¥Á†ÅÈ°µÈù¢
    // HMRouterMgr.push({
    //   pageUrl: PagePath.QRCODE
    // })
    router.push({url:"pages/QRCodePage"})
  }
}